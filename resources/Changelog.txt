Changelog
## 2.11.0 - ADMIN DATEPICKER + PRETTY LINKS ACCORDION UX üéØ
UPGRADES:
- ADDED: Calendar datepicker (Flatpickr) for From/To filters on Pretty Links and Phone tabs
- ENHANCED: Auto re-init of datepicker after AJAX table swaps (filters/pagination)
- ADDED: dd/mm/yyyy placeholders for consistent display format
- ENHANCED: Pretty Links page now includes collapsible sections (Stats, Quick Access, All Links) matching Phone tab UX
- ADDED: Quick-jump button row and saved open/closed state via localStorage

DEV NOTES:
- Flatpickr configured with altInput (d/m/Y) while submitting Y-m-d to PHP
- Custom DOM events dispatched after AJAX: `ls:links:loaded`, `ls:phone:loaded`
- No breaking changes to filters or endpoints

## 2.10.0 - PRETTY LINKS DIRECTORY FILTERS + EXPORT ‚úÖ
UPGRADES:
- ADDED: Filters (From/To created date, Redirect type 301/302/307/308, Search by slug/target URL, Per-page) in Pretty Links list table
- ADDED: CSV export for current filtered view via secure admin-post endpoint with nonce
- ENHANCED: List table now shows Redirect column (HTTP status)

FIXES:
- FIXED: Removed incorrect wpdb::prepare() usages without placeholders to eliminate WordPress warnings
- HARDENED: Defensive fallback for missing redirect_type (defaults to 301) to avoid notices on legacy rows

DEV NOTES:
- Conditional prepare() based on presence of params, safe LIMIT/OFFSET handling
- Export capped at 10k rows (configurable later)


Development
Support
Contributors & Developers

## 2.9.2 - PHONE REPORTING UX + NONCE COMPATIBILITY
UPGRADES:
- ADDED: Monthly counter card to Phone Tracking headline stats
- ADDED: 14‚Äëday Phone Activity sparkline with trend indicator (up/down/steady)
- ENHANCED: "Recent Phone Clicks" table now shows date, time, page/title link, source element (type/#id/.class), IP, and referrer
- INCREASED: Recent calls list now displays up to 50 rows

FIXES:
- FIXED: AJAX nonce verification now accepts both current ('leadstream_phone_click') and legacy ('leadstream_phone_nonce') tokens for compatibility

DEV NOTES:
- All queries use $wpdb->prepare() with placeholders
- Reporting reads click_date/click_time and falls back to clicked_at where needed

## 2.9.1 - DATABASE MIGRATION & SQL FIXES üîß
CRITICAL FIXES:
- FIXED: Database migration for existing installations missing link_type and link_key columns
- FIXED: All wpdb->prepare() calls now use proper placeholder syntax to eliminate WordPress warnings
- ADDED: Automatic schema migration on plugin activation for seamless upgrades
- ENHANCED: Phone Number Performance table showing per-number analytics (Total Calls, Today's Calls, Last Click)
- IMPROVED: Database indexes for better query performance on link_type and link_key fields

TECHNICAL IMPROVEMENTS:
- ADDED: Migration function in Installer class to update existing wp_ls_clicks tables
- FIXED: All SQL queries now use %s placeholders for string values and %d for integers
- ENHANCED: Phone analytics with grouped statistics and professional admin interface
- ADDED: Test Call and GA4 Event buttons for each tracked phone number
- IMPROVED: Backward compatibility with clicked_at field while using new schema

DATABASE SCHEMA:
- MIGRATED: Existing installations automatically get link_type and link_key columns
- ENHANCED: Better indexing for phone tracking queries and analytics
- FIXED: Foreign key constraints and proper data types throughout
- SECURED: All database operations use proper WordPress security practices

## 2.9.0 - ENHANCED PHONE TRACKING v2 üöÄ
REVOLUTIONARY PHONE TRACKING IMPROVEMENTS:
- REBUILT: Complete JavaScript phone tracking system with vanilla JS (no jQuery dependency)
- IMPROVED: Selector-free phone tracking - automatically detects ALL tel: links without configuration
- ENHANCED: Digit-only phone number matching for maximum compatibility across formats
- MODERNIZED: Fetch API replaces jQuery AJAX for better performance and reliability
- ADVANCED: Enhanced database schema with separate date/time fields for superior reporting

TECHNICAL ENHANCEMENTS:
- ADDED: Tracking method versioning for analytics migration and debugging
- IMPROVED: Enhanced IP address detection with Cloudflare and proxy support
- ENHANCED: Visual feedback system with CSS classes for tracked phone elements
- ADDED: Manual phone element re-scanning function for dynamic content compatibility
- UPGRADED: Modern security validation with improved nonce handling

ADMIN & DEBUGGING:
- IMPROVED: Enhanced admin interface with better explanations and cleaner design
- ADDED: Debug logging and comprehensive error reporting throughout system
- ENHANCED: Phone tracking metadata with element context and tracking version
- IMPROVED: Settings UI with clearer instructions and feature explanations
- ADDED: Advanced error handling and user feedback systems

COMPATIBILITY & PERFORMANCE:
- REMOVED: jQuery dependency for phone tracking (lighter, faster, more compatible)
- IMPROVED: Browser compatibility with modern JavaScript standards
- ENHANCED: Performance optimization for large sites with many phone numbers
- FIXED: CSS selectors now truly optional (robust tel: link detection works standalone)
- UPGRADED: Database structure supports advanced phone analytics and reporting

## 2.8.0 - PHONE CLICK TRACKING & CALL ANALYTICS üìû
MAJOR NEW FEATURES:
- ADDED: Complete phone click tracking system with dedicated "Phone Tracking" tab
- ADDED: Automatic detection of tel: links and custom phone elements via CSS selectors
- ADDED: Phone number configuration with support for multiple formats and numbers
- ADDED: Real-time phone click statistics (total, today, this week) in admin dashboard
- ADDED: Recent phone click history with IP addresses, timestamps, and user context

ANALYTICS INTEGRATION:
- ADDED: Google Analytics (GA4) events for phone clicks with detailed metadata
- ADDED: WordPress database storage for phone clicks in enhanced ls_clicks table
- ADDED: Advanced phone click data including element type, CSS classes, and page context
- ADDED: User tracking with IP address, user agent, referrer, and page information
- ADDED: Comprehensive phone click reporting alongside Pretty Links analytics

TECHNICAL ARCHITECTURE:
- ADDED: New PhoneHandler class for AJAX phone click processing
- ADDED: Enhanced database schema with link_type field supporting 'link' and 'phone' types
- ADDED: Frontend JavaScript library (phone-tracking.js) for automatic phone detection
- ADDED: Secure nonce-based AJAX communication for phone click recording
- ADDED: Smart phone number normalization and matching algorithms

ADMIN INTERFACE:
- ADDED: Professional phone tracking configuration interface with real-time stats
- ADDED: Phone number textarea supporting multiple formats (555-123-4567, +1-555-123-4567, etc.)
- ADDED: CSS selector configuration for tracking custom phone buttons and widgets
- ADDED: Enable/disable toggle for phone tracking functionality
- ADDED: Recent phone clicks table with comprehensive click details

PERFORMANCE & SECURITY:
- ADDED: Efficient database queries with proper indexing for phone tracking
- ADDED: Smart client IP detection handling proxies and load balancers
- ADDED: Comprehensive input sanitization and validation for all phone data
- ADDED: Backwards-compatible database schema maintaining existing Pretty Links functionality

## 2.7.0 - SPARKLINE ANALYTICS & DATA VISUALIZATION üìä
MAJOR NEW FEATURES:
- ADDED: Mini sparkline charts in Pretty Links List Table showing 7-day click trends
- ADDED: Larger sparkline visualization in Dashboard Widget showing 14-day activity
- ADDED: Trend indicators (üìà up, üìâ down, ‚û°Ô∏è steady) for quick performance insights
- ADDED: Interactive hover effects on sparklines with enhanced visual feedback
- ADDED: Comprehensive CSS styling for professional sparkline appearance

ANALYTICS ENHANCEMENTS:
- ENHANCED: List Table now includes "Trend (7d)" column with visual click patterns
- IMPROVED: Dashboard Widget shows overall site activity with trend analysis
- ADDED: Automated trend calculation comparing first/second week performance
- ENHANCED: Responsive sparkline design that adapts to different screen sizes
- ADDED: Professional gradient backgrounds and styling for data visualization

PERFORMANCE OPTIMIZATIONS:
- OPTIMIZED: Efficient database queries for sparkline data collection
- ADDED: Smart data aggregation for daily click counts over time periods
- ENHANCED: Minimal performance impact with targeted SQL queries
- IMPROVED: CSS animations and hover effects for smooth user interactions

## 2.6.6 - PRETTY LINKS UI/UX POLISH & MESSAGING IMPROVEMENTS üé®
FEATURE ENHANCEMENTS:
- ENHANCED: Pretty Links form messaging with clear value propositions
- ADDED: Real-time URL preview example showing before/after transformation
- IMPROVED: Form field descriptions with practical examples and use cases
- ADDED: Professional FAQ accordion with 6 comprehensive Q&As
- ENHANCED: WordPress-native styling throughout Pretty Links interface

UI/UX IMPROVEMENTS:
- ADDED: Enhanced form introduction with blue callout explaining benefits
- IMPROVED: Target URL messaging explaining UTM parameter handling
- ADDED: Live preview example box showing URL transformation
- ENHANCED: FAQ accordion with professional WordPress styling
- FIXED: FAQ header icon sizing and alignment issues
- IMPROVED: Text spacing and visual hierarchy throughout interface
- ADDED: Non-breaking space improvements for better text flow

ORGANIZATIONAL IMPROVEMENTS:
- MOVED: Quick Access Pretty Links section from JavaScript tab to Pretty Links tab
- IMPROVED: Logical grouping of all Pretty Links functionality in one location
- ENHANCED: Tab organization for better user experience
- FIXED: Content placement issues across different admin tabs

TECHNICAL FIXES:
- FIXED: FAQ accordion JavaScript functionality and smooth animations
- IMPROVED: CSS specificity for WordPress admin integration
- ENHANCED: Mobile responsiveness and cross-browser compatibility
- FIXED: Syntax errors in postbox header HTML structure

DEVELOPER NOTES:

## 2.6.5 - CODEMIRROR INTEGRATION FIX üéØ
CRITICAL FIXES:
- FIXED: Starter script generation broken due to CodeMirror API conflict
- FIXED: Copy buttons in FAQ section not working with CodeMirror editors
- FIXED: Code injection appearing then disappearing in textareas
- FIXED: Toggle switches targeting wrong textareas intermittently

TECHNICAL IMPROVEMENTS:
- Implemented dual-method approach for textarea manipulation
- Added CodeMirror API detection and fallback to native textarea methods
- Enhanced code injection reliability with smart CodeMirror wrapper detection
- Improved header/footer toggle switch logic validation

DEVELOPER NOTES:
- CodeMirror wraps textareas, requiring setValue() API instead of textarea.value
- Both starter script and copy buttons now handle CodeMirror compatibility
- Maintains backwards compatibility with non-CodeMirror setups
- All admin functionality now works reliably in both scenarios

## 2.6.0 - MAJOR MODULAR REFACTOR üéâ
BREAKING CHANGES:
- Complete architectural overhaul from monolithic to modular design
- Reduced main plugin file from 800+ lines to 24 lines (97% reduction)
- Implemented professional namespace-based class structure under \LS\ namespace

NEW MODULAR ARCHITECTURE:
- \LS\Admin\Assets - Handles CodeMirror and admin CSS/JS enqueuing
- \LS\Admin\Settings - Complete admin settings management (menu, fields, validation, UI)
- \LS\Frontend\Injector - Frontend JavaScript and GTM injection
- \LS\Utils - Shared sanitization and validation utilities

MIGRATION & CLEANUP:
- Executed safe, stepwise migration with zero downtime
- Maintained 100% backward compatibility during transition
- Removed all legacy commented code after verification
- All functionality preserved with improved maintainability

DEVELOPER BENEFITS:
- Clean separation of concerns for easier maintenance
- Modular structure enables easier feature additions
- Professional WordPress plugin architecture
- Improved code readability and debugging
- Future-ready for extensions and enhancements

## 2.5.5
Enhancements:
- Implemented robust switch-based CodeMirror system with three modes: 'auto' (WordPress first, CDN fallback), 'cdn' (CloudFlare CDN default), and 'wordpress' (WordPress only).
- Set CDN as default for maximum reliability and consistent syntax highlighting across all WordPress environments.
- Added comprehensive fallback logic to ensure JavaScript editor always works, regardless of WordPress CodeMirror availability.
- Removed debug echo statements after successful testing - plugin now runs clean in production.
- Enhanced editor initialization with proper dependency management and error handling.
- Optimized CodeMirror asset loading with version control and cache busting.

## 2.5.4
Enhancements:
- Refined admin footer badge: Now only displays on the LeadStream settings page using robust conditional logic (screen ID check).
- Cleaned up debug and legacy code for a professional, production-ready plugin.
- Improved repo hygiene and code comments for future maintainability.

## 2.5.3
Enhancements:
- Added a convenient "Settings" link beside "Deactivate" on the WordPress plugins page for quick access to plugin settings.

## 2.5.2
Enhancements:
- Added role security: Only users with 'manage_options' capability (admins) can access the settings page and save options. Access is strictly restricted for non-admins.

## 2.5.1
Bug Fixes:
- Fixed issue with event tracking not firing for Ninja Forms.

## 2.5.0
Enhancements:
- Added advanced event validation for all form builders.

## 2.4.0
Enhancements:
- Improved admin notice styling and dismissibility.

## 2.3.0
Enhancements:
- Introduced plugin conflict detection for Google Site Kit and MonsterInsights.
Bug Fixes:
- Fixed double-injection warning logic for header/footer JS.

## 2.2.0
Enhancements:
- Added Google Tag Manager integration (ID field, loader, noscript fallback).
Bug Fixes:
- Prevented fatal errors from invalid JS/PHP in code fields.

## 2.1.0
Enhancements:
- Added selectable starter script samples with checkboxes for platforms and major form builders.
Bug Fixes:
- Improved validation warnings for unreplaced placeholders and invalid GA4 IDs.

## 2.0.2
Enhancements:
- Enhanced security & privacy notices (GDPR, code safety, admin-only).
Bug Fixes:
- Fixed bug with settings page access for non-admins.

## 2.0.1
Bug Fixes:
- Fixed issue with settings not saving correctly for footer JS.

## 2.0.0
Features:
- Initial release: Basic JavaScript injection for header and footer.
Enhancements:
- Settings page with header/footer JS fields.
- Starter script button for common event tracking examples.
- Basic admin-only access and sanitization.
- Basic privacy and security notice.

## 1.1.1
Enhancements:
- Improved UI/UX for settings page, toggle switches, and quick start onboarding.

## 1.1.0
Enhancements:
- Added comprehensive event tracking samples and onboarding.

## 1.0.5
- Minor UI polish and bug fixes.

## 1.0.4
- Minor bug fixes.

## 1.0.3
- Minor bug fixes.

## 1.0.2
- Minor bug fixes.

## 1.0.1
- Minor bug fixes.

## 1.0.0
- Initial release: Basic features and security.

